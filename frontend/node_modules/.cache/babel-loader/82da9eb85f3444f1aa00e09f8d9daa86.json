{"ast":null,"code":"var _jsxFileName = \"/Users/kyeong/dev/java/Grids-Circles-Clone-APIServer/frontend/src/pages/order.js\",\n    _s = $RefreshSig$();\n\n// import './App.css';\nimport 'bootstrap/dist/css/bootstrap.css';\nimport { ProductList } from \"../components/ProductList\";\nimport { Summary } from \"../components/Summary\";\nimport axios from \"axios\";\nimport React, { useEffect, useState } from 'react';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport function Order(c) {\n  _s();\n\n  const [targetCategory, setTargetCategory] = useState(\"\");\n  const [products, setProducts] = useState([// {productId: 'uuid-1', productName: '콜롬비아 커피 1', category: '커피빈', price: 5000, quantity: 300},\n    // {productId: 'uuid-2', productName: '콜롬비아 커피 2', category: '커피빈', price: 5000, quantity: 300},\n    // {productId: 'uuid-3', productName: '콜롬비아 커피 3', category: '커피빈', price: 5000, quantity: 300},\n  ]);\n  const [items, setItems] = useState([]);\n\n  const handleAddClicked = productId => {\n    const product = products.find(v => v.productId === productId);\n    const found = items.find(v => v.productId === productId);\n    let updatedItems;\n\n    if (found) {\n      updatedItems = items.map(v => {\n        if (v.productId === productId) {\n          if (v.quantity - 1 < v.count) {\n            alert(\"선택된 양이 재고보다 많습니다.\");\n            return v;\n          } else {\n            return { ...v,\n              count: v.count + 1\n            };\n          }\n        } else {\n          return v;\n        }\n      });\n    } else {\n      updatedItems = [...items, { ...product,\n        count: 1\n      }];\n    }\n\n    setItems(updatedItems);\n  };\n\n  const handleRemoveClicked = productId => {\n    let flag = false;\n    const updatedItems = items.map((v, index) => {\n      if (v.productId === productId) {\n        //배열의 탐색 값이 선택한 값과 일치하면\n        if (v.count > 1) {\n          //선택된 상품의 개수가 0 초과인 경우\n          flag = true;\n          return { ...v,\n            count: v.count - 1\n          };\n        } else {\n          //선택된 상품의 개수가 0 이하인 경우\n          setItems(items.filter(p => p.productId !== productId));\n          return;\n        }\n      } else {\n        return v;\n      }\n    });\n\n    if (flag) {\n      setItems(updatedItems);\n    }\n  };\n\n  useEffect(() => {\n    console.log(targetCategory.length);\n\n    if (targetCategory.length > 0) {\n      axios.get('http://localhost:8080/api/v1/products?category=' + targetCategory).then(v => setProducts(v.data));\n    }\n\n    axios.get('http://localhost:8080/api/v1/products').then(v => setProducts(v.data));\n  }, []);\n\n  const handleOrderSubmit = order => {\n    if (items.length === 0) {\n      alert(\"아이템을 추가해 주세요!\");\n    } else {\n      axios.post('http://localhost:8080/api/v1/orders', {\n        email: order.email,\n        address: order.address,\n        postcode: order.postcode,\n        orderItems: items.map(v => ({\n          productId: v.productId,\n          category: v.category,\n          price: v.price,\n          quantity: v.count\n        }))\n      }).then(v => alert(\"주문이 정상적으로 접수되었습니다.\"), e => {\n        alert(\"서버 장애\");\n        console.error(e);\n      });\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [\"(\", /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"card\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"row\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"col-md-8 mt-4 d-flex flex-column align-items-start p-3 pt-0\",\n          children: /*#__PURE__*/_jsxDEV(ProductList, {\n            products: products,\n            onAddClick: handleAddClicked,\n            onRemoveClick: handleRemoveClicked,\n            setTargetCategory: setTargetCategory\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 102,\n            columnNumber: 21\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 101,\n          columnNumber: 17\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"col-md-4 summary p-4\",\n          children: /*#__PURE__*/_jsxDEV(Summary, {\n            items: items,\n            onOrderSubmit: handleOrderSubmit\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 105,\n            columnNumber: 21\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 104,\n          columnNumber: 17\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 13\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 9\n    }, this), \")\"]\n  }, void 0, true);\n}\n\n_s(Order, \"zWoxV4jtaeCTUkwMoQ2NuS6lA1o=\");\n\n_c = Order;\nexport default Order;\n\nvar _c;\n\n$RefreshReg$(_c, \"Order\");","map":{"version":3,"names":["ProductList","Summary","axios","React","useEffect","useState","Order","c","targetCategory","setTargetCategory","products","setProducts","items","setItems","handleAddClicked","productId","product","find","v","found","updatedItems","map","quantity","count","alert","handleRemoveClicked","flag","index","filter","p","console","log","length","get","then","data","handleOrderSubmit","order","post","email","address","postcode","orderItems","category","price","e","error"],"sources":["/Users/kyeong/dev/java/Grids-Circles-Clone-APIServer/frontend/src/pages/order.js"],"sourcesContent":["// import './App.css';\nimport 'bootstrap/dist/css/bootstrap.css';\nimport {ProductList} from \"../components/ProductList\";\nimport {Summary} from \"../components/Summary\";\nimport axios from \"axios\";\nimport React, {useEffect, useState} from 'react';\n\n\nexport function Order(c) {\n    const [targetCategory, setTargetCategory] = useState(\"\");\n\n    const [products, setProducts] = useState([\n        // {productId: 'uuid-1', productName: '콜롬비아 커피 1', category: '커피빈', price: 5000, quantity: 300},\n        // {productId: 'uuid-2', productName: '콜롬비아 커피 2', category: '커피빈', price: 5000, quantity: 300},\n        // {productId: 'uuid-3', productName: '콜롬비아 커피 3', category: '커피빈', price: 5000, quantity: 300},\n\n    ]);\n\n    const [items, setItems] = useState([]);\n\n    const handleAddClicked = productId => {\n        const product = products.find(v => v.productId === productId);\n        const found = items.find(v => v.productId === productId);\n        let updatedItems;\n        if (found) {\n            updatedItems = items.map(v => {\n                if (v.productId === productId) {\n                    if (v.quantity-1 < v.count) {\n                        alert(\"선택된 양이 재고보다 많습니다.\")\n                        return v;\n                    } else {\n                        return {...v, count: v.count + 1};\n                    }\n                } else {\n                    return v;\n                }\n            });\n        }else{\n            updatedItems = [...items, {...product, count: 1}];\n        }\n        setItems(updatedItems);\n    };\n\n    const handleRemoveClicked = productId => {\n        let flag = false;\n        const updatedItems = items.map((v,index) => {\n            if (v.productId === productId) {//배열의 탐색 값이 선택한 값과 일치하면\n                if(v.count > 1) {//선택된 상품의 개수가 0 초과인 경우\n                    flag = true;\n                    return {...v, count: v.count -1}\n                }else{//선택된 상품의 개수가 0 이하인 경우\n                    setItems(items.filter((p) =>  p.productId !== productId ));\n                    return;\n                }\n            }else{\n                return v\n            }\n        });\n        if(flag){\n            setItems(updatedItems);\n        }\n    }\n\n    useEffect(() => {\n        console.log(targetCategory.length)\n        if(targetCategory.length > 0){\n        axios.get('http://localhost:8080/api/v1/products?category='+targetCategory)\n                .then(v => setProducts(v.data));\n        }\n            axios.get('http://localhost:8080/api/v1/products')\n                .then(v => setProducts(v.data));\n\n\n    }, []);\n\n    const handleOrderSubmit = (order) => {\n        if (items.length === 0) {\n            alert(\"아이템을 추가해 주세요!\");\n        } else {\n            axios.post('http://localhost:8080/api/v1/orders', {\n                email: order.email,\n                address: order.address,\n                postcode: order.postcode,\n                orderItems: items.map(v => ({\n                    productId: v.productId,\n                    category: v.category,\n                    price: v.price,\n                    quantity: v.count\n                }))\n            }).then(\n                v => alert(\"주문이 정상적으로 접수되었습니다.\"),\n                e => {\n                    alert(\"서버 장애\");\n                    console.error(e);\n                })\n        }\n    }\n    return <>(\n        <div className=\"card\">\n            <div className=\"row\">\n                <div className=\"col-md-8 mt-4 d-flex flex-column align-items-start p-3 pt-0\">\n                    <ProductList products={products} onAddClick={handleAddClicked} onRemoveClick={handleRemoveClicked} setTargetCategory={setTargetCategory} />\n                </div>\n                <div className=\"col-md-4 summary p-4\">\n                    <Summary items={items} onOrderSubmit={handleOrderSubmit}/>\n                </div>\n            </div>\n        </div>\n        )\n        </>\n}\n\nexport default Order;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}